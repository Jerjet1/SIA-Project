{% extends "core/Custodian/Inventory.html" %}
{% load static tailwind_tags %}
{% block content %}
<div class="w-full bg-white flex justify-center items-center">
    <div class="w-[50rem] h-[35rem]  mt-10">
        <!--search-->
        <div class=" min-w-full h-20 pt-2">
            <input type="text" placeholder="Search" class="h-9 mt-6 rounded-3xl hover:border-blue-700">
        </div>
        <!--table container-->
        <div class="min-w-full h-[26rem] bg-gray-3">
            <table class="w-full table-auto">
                <thead class="bg-gray-200 border-b-3 border-gray-200">
                    <tr class="">
                        <th class="p-3 text-sm font-semibold tracking-wide text-center">Delivey ID</th>
                        <th class="p-3 text-sm font-semibold tracking-wide text-center">Item</th>
                        <th class="p-3 text-sm font-semibold tracking-wide text-center">Quantity</th>
                        <th class="p-3 text-sm font-semibold tracking-wide text-center">Supplier</th>
                        <th class="p-3 text-sm font-semibold tracking-wide text-center">total</th>
                        <th class="p-3 text-sm font-semibold tracking-wide text-center">status</th>
                        <th class="p-3 text-sm font-semibold tracking-wide text-center">Action</th>
                    </tr>
                </thead>
                <tbody class="">
                    {% for delivery in check_deliveries %}
                    <tr class="text-center">
                        <td class="pt-1 mt-1">{{delivery.delivery_id}}</td>
                        <td class="pt-1 mt-1">{{delivery.delivery_item}}</td>
                        <td class="pt-1 mt-1">{{delivery.delivery_quantity}}</td>
                        <td class="pt-1 mt-1">{{delivery.delivery_supplier}}</td>
                        <td class="pt-1 mt-1">â‚±{{delivery.delivery_total}}</td>
                        <td class="pt-1">
                            <span class="bg-orange-600 text-white px-3 py-1.5 rounded-xl text-base">
                                {{delivery.delivery_status}}
                            </span>
                        </td>
                        <td class="pt-1 mt-1">
                            <button class="bg-gray-2 text-white px-3 py-1 rounded-lg" 
                            onclick="openModal('accept-{{delivery.delivery_id}}')">accept</button>
                            <button class="bg-gray-2 text-white px-3 py-1 rounded-lg" 
                            onclick="openModal('return-{{delivery.delivery_id}}')">return</button>
                        </td>
                        <!--accept modal-->
                        <div id="accept-{{delivery.delivery_id}}" class="modal hidden fixed inset-0 
                        bg-black bg-opacity-50 items-center justify-center">
                            <div class="bg-white rounded-lg p-6 space-y-4 relative">
                                <div class="top-1 left-[26rem] absolute">
                                    <button type="button"
                                        class="text-black  rounded-full ml-4"
                                        onclick="closeModal('accept-{{delivery.delivery_id}}')">
                                        <img src="{% static 'images/closebtn.png' %}" alt="closebutton" class="w-7 h-7 ">
                                    </button>
                                </div>
                                <h2 class="text-lg font-bold text-center">Confirm Order</h2>
                                <p class="text-center text-gray-600">Click <strong>Yes</strong> to process the transaction for the delivered order.</p>
                                <div class="flex justify-center items-center">
                                    <form method="POST" action="{% url 'accept_delivery' delivery_id=delivery.delivery_id%}">
                                        {%csrf_token%}
                                        <button type="submit" class="bg-gray-2 text-white px-4 py-2 rounded-2xl 
                                        hover:text-orange-500">Yes</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <!--accept modal-->
                        <div id="return-{{delivery.delivery_id}}" class="modal hidden fixed inset-0 
                        bg-black bg-opacity-50 items-center justify-center">
                            <div class="bg-white rounded-lg p-6 space-y-4 relative">
                                <div class="top-1 left-[26rem] absolute">
                                    <button type="button"
                                        class="text-black  rounded-full ml-4"
                                        onclick="closeModal('return-{{delivery.delivery_id}}')">
                                        <img src="{% static 'images/closebtn.png' %}" alt="closebutton" class="w-7 h-7 ">
                                    </button>
                                </div>
                                <h2 class="text-lg font-bold text-center">Confirm Order</h2>
                                <p class="text-center text-gray-600">Click <strong>Yes</strong> to process the transaction for the delivered order.</p>
                                <div class="flex justify-center items-center">
                                    <form method="POST" action="">
                                        {%csrf_token%}
                                        <button type="submit" class="bg-gray-2 text-white px-4 py-2 rounded-2xl 
                                        hover:text-orange-500">Yes</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
<script>
    function openModal(modalId) {
    const modal = document.getElementById(modalId);
    modal.classList.remove('hidden'); // Remove hidden class
    modal.classList.add('flex'); // Add flex for centering
    }

    function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    modal.classList.remove('flex'); // Remove flex to prevent display issues
    modal.classList.add('hidden'); // Add hidden class to hide modal
    }
</script>

{% endblock %}